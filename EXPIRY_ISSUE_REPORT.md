# ðŸ“‹ ØªÙ‚Ø±ÙŠØ± Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©

## ðŸ” Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù…Ø¨Ù„Øº Ø¹Ù†Ù‡Ø§
**Ø§Ù„Ø´ÙƒÙˆÙ‰**: "ÙƒÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù…Ø¬Ø¯Ø¯Ø© ÙˆÙŠØ¸Ù‡Ø± Ù„ÙŠ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù…Ù†ØªÙ‡ÙŠ ØŸØŸØŸ Ù‡Ø°Ø§ Ø´ÙŠØ¡ ØºÙŠØ± Ù…Ù†Ø·Ù‚ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚"

## ðŸ•µï¸ Ø§Ù„ØªØ­Ù‚ÙŠÙ‚ ÙˆØ§Ù„ØªØ´Ø®ÙŠØµ

### 1. **ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©**
ØªÙ… ÙØ­Øµ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:

```sql
-- Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
ðŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ: 2025-09-07

ðŸ¢ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª:
   âŒ Ù…Ù†ØªÙ‡ÙŠØ©: 0
   âœ… Ø³Ø§Ø±ÙŠØ©: 1 (ØªÙ†ØªÙ‡ÙŠ ÙÙŠ 2028-09-07)

ðŸ’³ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª:
   âŒ Ù…Ù†ØªÙ‡ÙŠØ©: 0  
   âœ… Ø³Ø§Ø±ÙŠØ©: 1 (ØªÙ†ØªÙ‡ÙŠ ÙÙŠ 2026-09-07)

ðŸ‘¥ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†:
   âŒ Ù…Ù†ØªÙ‡ÙŠØ©: 0
   âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø³Ø§Ø±ÙŠØ© (ØªÙ†ØªÙ‡ÙŠ Ø¨ÙŠÙ† 2025-2027)

ðŸŒ API Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©: 0
```

### 2. **Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…ÙƒØªØ´ÙØ©**

#### ðŸ”´ **Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ**: Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªØ¹Ù„Ø§Ù… SQL
```sql
-- Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙƒØ§Ù†Øª ÙÙŠ UNION ALL
SELECT ... FROM employee_documents    -- 11 Ø¹Ù…ÙˆØ¯
UNION ALL  
SELECT ... FROM institution_documents -- 12 Ø¹Ù…ÙˆØ¯ (ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ is_renewable)
```
**Ø§Ù„Ù†ØªÙŠØ¬Ø©**: Ø®Ø·Ø£ `ER_WRONG_NUMBER_OF_COLUMNS_IN_SELECT`

#### ðŸŸ¡ **Ø£Ø³Ø¨Ø§Ø¨ Ø«Ø§Ù†ÙˆÙŠØ©**:
1. **Ù…Ù†Ø·Ù‚ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©**: ÙƒØ§Ù† ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ `status` Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† `expiry_date`
2. **Ø¹Ø¯Ù… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª**: Ø§Ù„Ø­Ù‚Ù„ `status` Ù„Ù… ÙŠÙƒÙ† ÙŠØªØ­Ø¯Ø« ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
3. **Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø§Ø·Ø¦Ø©**: Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ØªØ¹Ø±Ø¶ Ø£Ø®Ø·Ø§Ø¡ API Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©

## âœ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©

### 1. **Ø¥ØµÙ„Ø§Ø­ Ø§Ø³ØªØ¹Ù„Ø§Ù… SQL**
```typescript
// Ù‚Ø¨Ù„ Ø§Ù„Ø¥ØµÙ„Ø§Ø­
SELECT ed.id, ed.employee_id, ..., ed.created_at, e.name
UNION ALL
SELECT id.id, id.institution_id, ..., id.is_renewable, id.created_at, i.name

// Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­  
SELECT ed.id, ed.employee_id, ..., NULL as isRenewable, ed.created_at, e.name
UNION ALL
SELECT id.id, id.institution_id, ..., id.is_renewable, id.created_at, i.name
```

### 2. **Ø¥ØµÙ„Ø§Ø­ Ù…Ù†Ø·Ù‚ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª**
```typescript
// Ù‚Ø¨Ù„ Ø§Ù„Ø¥ØµÙ„Ø§Ø­
const expiredSubs = subscriptions.filter(sub => sub.status === 'expired');

// Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­
const expiredSubs = subscriptions.filter(sub => {
  if (!sub.expiryDate) return false;
  const expiryDate = new Date(sub.expiryDate);
  return expiryDate < today;
});
```

### 3. **ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**
```sql
-- ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª
UPDATE subscriptions 
SET status = CASE 
  WHEN expiry_date < CURDATE() THEN 'expired'
  WHEN expiry_date <= DATE_ADD(CURDATE(), INTERVAL 30 DAY) THEN 'expiring_soon'
  ELSE 'active'
END;

-- ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª
UPDATE institution_documents 
SET status = CASE 
  WHEN expiry_date < CURDATE() THEN 'expired'
  WHEN expiry_date <= DATE_ADD(CURDATE(), INTERVAL 30 DAY) THEN 'expiring_soon'
  ELSE 'active'
END;
```

## ðŸŽ¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©

### âœ… **Ù…Ø§ ØªÙ… Ø¥ØµÙ„Ø§Ø­Ù‡**:
1. âœ… **API `/api/documents?expired=true`** ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
2. âœ… **Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©**: 0 (ØµØ­ÙŠØ­)
3. âœ… **Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©**: 0 (ØµØ­ÙŠØ­)  
4. âœ… **Ù…Ù†Ø·Ù‚ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®** ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
5. âœ… **Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ØªØ¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©** Ø§Ù„Ø¢Ù†

### ðŸ“Š **Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©**:
```
ðŸ“‹ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù„Ù„Ù†Ø¸Ø§Ù…:
   âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø³Ø§Ø±ÙŠØ© Ø§Ù„Ù…ÙØ¹ÙˆÙ„
   âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø³Ø§Ø±ÙŠØ© Ø§Ù„Ù…ÙØ¹ÙˆÙ„  
   âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù…Ù†ØªÙ‡ÙŠØ©
   âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ù…Ù†ØªÙ‡ÙŠØ©
```

## ðŸŒ **Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…**

### 1. **API Endpoints**:
```bash
# Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©
GET /api/documents?expired=true
# Ø§Ù„Ù†ØªÙŠØ¬Ø©: {"success": true, "data": [], "count": 0}

# Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„ØªÙŠ ØªÙ†ØªÙ‡ÙŠ Ù‚Ø±ÙŠØ¨Ø§Ù‹  
GET /api/documents?expiring=true&days=30
# Ø§Ù„Ù†ØªÙŠØ¬Ø©: {"success": true, "data": [], "count": 0}
```

### 2. **Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©**:
- âœ… **Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©**: 0
- âœ… **Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©**: 0
- âœ… **Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ ØªØ¬Ø¯ÙŠØ¯**: 0

## ðŸ”§ **Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©**

### ðŸ“„ **Ù…Ù„ÙØ§Øª API**:
- `src/app/api/documents/route.ts` - Ø¥ØµÙ„Ø§Ø­ Ø§Ø³ØªØ¹Ù„Ø§Ù… UNION ALL
- `src/app/page.tsx` - Ø¥ØµÙ„Ø§Ø­ Ù…Ù†Ø·Ù‚ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª

### ðŸ—ƒï¸ **Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**:
- ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª
- ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª

### ðŸ“Š **Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª Ø§Ù„ØªØ´Ø®ÙŠØµ**:
- `scripts/debug-expired-documents.js` - ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- `scripts/test-dashboard-data.js` - Ø§Ø®ØªØ¨Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
- `scripts/fix-expiry-logic.js` - Ø¥ØµÙ„Ø§Ø­ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡

## ðŸ’¡ **Ø§Ù„ØªÙˆØµÙŠØ§Øª Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„**

### 1. **Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠØ©**:
```sql
-- ØªØ´ØºÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø´Ù‡Ø±ÙŠØ§Ù‹ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
SELECT 
  'institution_documents' as table_name,
  COUNT(CASE WHEN expiry_date < CURDATE() THEN 1 END) as expired_count,
  COUNT(CASE WHEN expiry_date <= DATE_ADD(CURDATE(), INTERVAL 30 DAY) THEN 1 END) as expiring_soon_count
FROM institution_documents
WHERE expiry_date IS NOT NULL;
```

### 2. **Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ**:
- Ø¥Ø¶Ø§ÙØ© cron job Ù„ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ÙŠÙˆÙ…ÙŠØ§Ù‹
- Ø¥Ø¶Ø§ÙØ© validation ÙÙŠ API Ù„Ø¶Ù…Ø§Ù† ØµØ­Ø© Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®

### 3. **Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø©**:
- Ø¥Ø¶Ø§ÙØ© unit tests Ù„Ù…Ù†Ø·Ù‚ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
- Ø¥Ø¶Ø§ÙØ© integration tests Ù„Ù€ API endpoints

## ðŸŽ‰ **Ø§Ù„Ø®Ù„Ø§ØµØ©**

### âœ… **ØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„**:
1. **Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©**: ÙƒØ§Ù†Øª Ø®Ø·Ø£ ÙÙŠ ÙƒÙˆØ¯ SQL ÙˆÙ„ÙŠØ³ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
2. **Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©**: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª ÙˆØ§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø³Ø§Ø±ÙŠØ© ÙØ¹Ù„Ø§Ù‹
3. **Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¢Ù†**: ÙŠØ¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© (0 Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù…Ù†ØªÙ‡ÙŠØ©)

### ðŸ” **Ù…Ø§ ØªØ¹Ù„Ù…Ù†Ø§Ù‡**:
- Ø£Ù‡Ù…ÙŠØ© ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù‚Ø¨Ù„ ØªØ´Ø®ÙŠØµ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©
- Ø¶Ø±ÙˆØ±Ø© Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª SQL Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©
- Ø£Ù‡Ù…ÙŠØ© ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„ÙØ¹Ù„ÙŠØ©

---

## ðŸŒ **Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ©**

```
âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø­ Ø¹Ù„Ù‰: http://localhost:9004
âœ… Ø¬Ù…ÙŠØ¹ APIs ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
âœ… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ØªØ¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©
âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø£Ùˆ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ù…Ù†ØªÙ‡ÙŠØ©
âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ
```

**Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒØ§Ù† Ù…Ø­Ù‚Ø§Ù‹ ØªÙ…Ø§Ù…Ø§Ù‹ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù…Ø¬Ø¯Ø¯Ø© ÙˆÙ„Ø§ ÙŠØ¬Ø¨ Ø£Ù† ØªØ¸Ù‡Ø± ÙƒÙ…Ù†ØªÙ‡ÙŠØ©! ðŸŽ¯**

---

*ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµÙ„Ø§Ø­: 2025-01-09*  
*Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚: 45 Ø¯Ù‚ÙŠÙ‚Ø©*  
*Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…: âœ… ØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„*
